<%- include('partials/header.ejs') %>

<div class="main-panel">
  <div class="content-wrapper pb-0">
    <div class="page-header flex-wrap justify-content-between align-items-center">
      <h3 class="mb-0">
        üëã Hi <%= (user && (user.username || user.name)) ? (user.username || user.name) : 'Guest' %>,
        <span class="text-muted h6">welcome back to your Recipe World!</span>
      </h3>
      <a href="/recipe/add" class="btn btn-success shadow-sm px-4 py-2 rounded-pill">‚ûï Add Recipe</a>
    </div>

    <!-- Recipes Section -->
    <div class="row mt-4 g-4">
      <% if (recipes && recipes.length > 0) { %>
        <% recipes.forEach(recipe => { %>
          <div class="col-md-4 col-sm-6">
            <div class="recipe-card shadow-lg border-0" onclick="window.location.href='/recipe/<%= recipe._id %>'">
              
              <!-- Image -->
              <div class="recipe-img-container">
                <img src="<%= recipe.image ? recipe.image : '/images/placeholder-food.jpg' %>" 
                     alt="<%= recipe.name %>" class="recipe-img">
                <div class="recipe-overlay">
                  <h4 class="recipe-title"><%= recipe.name %></h4>
                  <% if (recipe.cuisine) { %>
                    <span class="badge bg-light text-dark mt-2"><%= recipe.cuisine %></span>
                  <% } %>
                </div>
              </div>

              <!-- Body -->
              <div class="card-body text-center">
                <p class="text-muted mb-1">
                  <i class="mdi mdi-clock-outline"></i> Ready in <%= recipe.time %> mins
                </p>
                <p class="recipe-desc">
                  <%= recipe.description.length > 100 ? recipe.description.substring(0, 100) + '...' : recipe.description %>
                </p>
              </div>

              <!-- Footer -->
              <div class="card-footer bg-white d-flex justify-content-between align-items-center border-top">
                <small class="text-muted">üë®‚Äçüç≥ By 
                  <%= recipe.author ? (recipe.author.username || recipe.author.name || 'Unknown') : 'Unknown' %>
                </small>
                <a href="/recipe/<%= recipe._id %>" class="btn btn-outline-primary btn-sm rounded-pill">View</a>
              </div>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <div class="col-12 text-center mt-5">
          <h5 class="text-muted">No recipes found yet.</h5>
          <a href="/recipe/add" class="btn btn-success mt-3 rounded-pill">Add Your First Recipe</a>
        </div>
      <% } %>
    </div>
  </div>
</div>

<%- include('partials/footer.ejs') %>

<!-- CSS -->
<style>
  .recipe-card {
    border-radius: 16px;
    overflow: hidden;
    cursor: pointer;
    background-color: #fff;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .recipe-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
  }

  .recipe-img-container {
    position: relative;
    width: 100%;
    height: 220px;
    overflow: hidden;
  }

  .recipe-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.4s ease;
  }

  .recipe-card:hover .recipe-img {
    transform: scale(1.1);
  }

  .recipe-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background: linear-gradient(transparent, rgba(0,0,0,0.7));
    color: white;
    padding: 15px;
    text-align: left;
  }

  .recipe-title {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 5px;
  }

  .recipe-desc {
    font-size: 0.95rem;
    color: #555;
    min-height: 50px;
  }

  .badge {
    font-size: 0.75rem;
    padding: 4px 8px;
    border-radius: 12px;
  }

  .card-footer {
    font-size: 0.85rem;
    padding: 10px 15px;
  }

  .btn-outline-primary {
    transition: all 0.3s ease;
  }

  .btn-outline-primary:hover {
    background-color: #007bff;
    color: #fff;
  }
</style>
